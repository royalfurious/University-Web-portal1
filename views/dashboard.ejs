<%- include('partials/header', { title: 'Dashboard - University Portal' }) %>

<section class="card single">
  <h2>Hello, <%= user.full_name %></h2>
  <p class="muted">Logged in as <strong><%= user.role.charAt(0).toUpperCase() + user.role.slice(1) %></strong></p>
</section>

<% if (user.role === 'admin' && typeof adminStats !== 'undefined' && adminStats) { %>
  <section class="cards">
    <article class="card" style="text-align:center">
      <p class="muted">Total Students</p>
      <p class="score"><%= adminStats.students %></p>
    </article>
    <article class="card" style="text-align:center">
      <p class="muted">Total Faculty</p>
      <p class="score"><%= adminStats.faculty %></p>
    </article>
    <article class="card" style="text-align:center">
      <p class="muted">Total Courses</p>
      <p class="score"><%= adminStats.classes %></p>
    </article>
    <article class="card" style="text-align:center">
      <p class="muted">Total Submissions</p>
      <p class="score"><%= adminStats.submissions %></p>
    </article>
  </section>
<% } %>

<% if (user.role === 'faculty') { %>
  <section>
    <h3>Your Classes</h3>
    <div class="cards">
      <% if (summary.length === 0) { %>
        <article class="card"><p class="muted">No classes assigned yet.</p></article>
      <% } else { %>
        <% summary.forEach((item) => { %>
          <article class="card">
            <h4><%= item.code %> - <%= item.title %></h4>
            <p>Students Enrolled: <strong><%= item.student_count %></strong></p>
          </article>
        <% }) %>
      <% } %>
    </div>
  </section>
<% } %>

<% if (user.role === 'student') { %>
  <section>
    <h3>Your Courses & Assignments</h3>
    <div class="cards">
      <% if (summary.length === 0) { %>
        <article class="card"><p class="muted">No enrolled courses yet.</p></article>
      <% } else { %>
        <% summary.forEach((item) => { %>
          <article class="card">
            <h4><%= item.code %> - <%= item.title %></h4>
            <p>Assignment: <%= item.assignment_title || 'No assignment posted yet' %></p>
            <small>Due: <%= item.due_date || 'TBD' %></small>
          </article>
        <% }) %>
      <% } %>
    </div>
  </section>
<% } %>

<%- include('partials/footer') %>
